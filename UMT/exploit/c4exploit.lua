--// Tables
local correspondances = {
    ["Dynamite Level 1"] = "TNT1",
    ["Dynamite Level 2"] = "TNT2",
    ["Dynamite Level 3"] = "TNT3",
    ["Dynamite Bundle Level 1"] = "TNTBundle1",
    ["Dynamite Bundle Level 2"] = "TNTBundle2",
    ["Dynamite Bundle Level 3"] = "TNTBundle3",
    ["C4 Level 1"] = "C41",
    ["C4 Level 2"] = "C42",
    ["C4 Level 3"] = "C43",
    ["C4 Level 4"] = "C44",
    ["C4 Level 5"] = "C45",
}

local correspondancesPioche = {
    ["Rusty Pickaxe"] = "RustyPick",
    ["Iron Pickaxe"] = "IronPick",
    ["Steel Pickaxe"] = "SteelPick",
    ["Platinum Pickaxe"] = "PlatinumPick",
    ["Titanium Pickaxe"] = "TitaniumPick",
    ["Infernum Pickaxe"] = "InfernumPick",
    ["Diamond Pickaxe"] = "DiamondPick",
    ["Mithril Pickaxe"] = "MithrilPick",
    ["Adamantium Pickaxe"] = "AdamantiumPick",
    ["Unobtainium Pickaxe"] = "UnobtainiumPick",
}

--// Variables
local player = game.Players.LocalPlayer
local plrBackpack = player.InnoBackpack:GetChildren()

--// 1. On déséquipe tous les C4 possibles
for key, value in pairs(correspondances) do
    local c4 = player.Character:FindFirstChild(key) or player.InnoBackpack:FindFirstChild(key)
    if c4 then
        local args = {
            [1] = false
        }
        c4.EquipRemote:FireServer(unpack(args))
    end
end

--// 2. On cherche et équipe la pioche du joueur
local piocheTrouvee = nil

for i, item in ipairs(plrBackpack) do
    if correspondancesPioche[item.Name] then
        piocheTrouvee = item.Name
        break
    end
end

if piocheTrouvee then
    local args = {
        [1] = true
    }
    player.InnoBackpack:FindFirstChild(piocheTrouvee).EquipRemote:FireServer(unpack(args))
end

wait(0.1) -- Pause pour laisser le temps au serveur

--// 3. On équipe TNT1 puis l'explosif actuel
local correspondanceExplosive = nil
plrBackpack = player.InnoBackpack:GetChildren() -- Refresh backpack

for i = 1, #plrBackpack do
    local itemName = plrBackpack[i].Name
    correspondanceExplosive = correspondances[itemName]

    if correspondanceExplosive then
        break
    end
end

if correspondanceExplosive then
    local args = {
        [1] = 23,
        [2] = "Explosive",
        [3] = "TNT1"
    }
    game:GetService("ReplicatedStorage").MadCommEvents:FindFirstChild("4").EquipTool:FireServer(unpack(args))

    wait(0.05)

    local args = {
        [1] = 23,
        [2] = "Explosive",
        [3] = correspondanceExplosive
    }
    game:GetService("ReplicatedStorage").MadCommEvents:FindFirstChild("4").EquipTool:FireServer(unpack(args))
end
